VERSION THAT IS USED IN MY THESIS. HAD SIGNIFICANT PROBLEMS FOR LARGE FUEL PENALTIES